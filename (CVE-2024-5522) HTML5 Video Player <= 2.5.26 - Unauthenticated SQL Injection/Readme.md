The HTML5 Video Player – Best WordPress Video Player Plugin and Block plugin for WordPress is vulnerable to SQL Injection in all versions up to, and including, 2.5.26 due to insufficient escaping on a user supplied parameter and lack of sufficient preparation on the existing SQL query. This makes it possible for unauthenticated attackers to append additional SQL queries into already existing queries that can be used to extract sensitive information from the database.

Kiểm tra 2 phiên bản 26 và 27

thấy rằng đoạn code fix có vẻ dễ dàng gây ra lỗi sqli ở \inc\Rest\VideoController.php

![image](https://github.com/Nguyen-Trung-Kien/Wordpress-CVE--Reproduct/assets/65381453/44c52875-7401-44c0-b079-8f2757f7bc56)

ở function get_item,

gọi tới router rest

![image](https://github.com/Nguyen-Trung-Kien/Wordpress-CVE--Reproduct/assets/65381453/6b25eae4-304d-446d-9dc4-78849f6edb34)

có namespace 

![image](https://github.com/Nguyen-Trung-Kien/Wordpress-CVE--Reproduct/assets/65381453/c9f37413-16c3-49ed-a7e0-efaadb98ba87)

từ đây có thể truy ra requests

![image](https://github.com/Nguyen-Trung-Kien/Wordpress-CVE--Reproduct/assets/65381453/6b172183-d816-48ad-9961-79a8e12212fd)

ở đoạn regex trên có thể thấy rằng nó chỉ lấy phần id là số
![image](https://github.com/Nguyen-Trung-Kien/Wordpress-CVE--Reproduct/assets/65381453/9629d8d9-c828-4e24-a838-4305c46dbbb9)

thêm 1 paramter id khác ở đây

![image](https://github.com/Nguyen-Trung-Kien/Wordpress-CVE--Reproduct/assets/65381453/ad44874b-8614-4828-a738-168df8497ffe)

kiểm tra xem 2 parameter này nó sẽ đi về đâu

![image](https://github.com/Nguyen-Trung-Kien/Wordpress-CVE--Reproduct/assets/65381453/a08a8a0d-c07c-476b-b5e1-9cc034e5a9d8)

![image](https://github.com/Nguyen-Trung-Kien/Wordpress-CVE--Reproduct/assets/65381453/7f2a4762-bc5b-40ee-82a9-57ced6bfc2b0)

nó sẽ đi qua vòng lặp với từng giá trị

![image](https://github.com/Nguyen-Trung-Kien/Wordpress-CVE--Reproduct/assets/65381453/2d3b516f-8255-45bc-9b55-72dca99fee8e)

1 url -> id -> 1
![image](https://github.com/Nguyen-Trung-Kien/Wordpress-CVE--Reproduct/assets/65381453/a0ada967-9743-4625-9765-73a6424ac1f9)
2  GET -> id -> 1'''
![image](https://github.com/Nguyen-Trung-Kien/Wordpress-CVE--Reproduct/assets/65381453/fe62cd17-f0ec-4ac3-a9d6-def36e0dd349)

qua đây nó sẽ lấy parameter GET ở sau ghi đè lên paramter URL ở trước 

![image](https://github.com/Nguyen-Trung-Kien/Wordpress-CVE--Reproduct/assets/65381453/d5d8dae9-dac8-46ca-a9b4-b875c0c844b7)

tới đoạn select này giá trị đầu vào sẽ gây ra lỗi SQLi

POC:
![image](https://github.com/Nguyen-Trung-Kien/Wordpress-CVE--Reproduct/assets/65381453/b0e329d4-803e-48e1-926b-bedbb9222dbe)

```
http://localhost:8088/wp-json/h5vp/v1/video/1?id='+or+sleep(5)--+-
```
