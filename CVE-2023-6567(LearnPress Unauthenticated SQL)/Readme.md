description

![image](https://github.com/Nguyen-Trung-Kien/Wordpress-CVE--Reproduct/assets/65381453/656c6a42-8947-46c2-83c0-c1b1d49a01ac)

# diff version 4.2.5.7 và 4.2.5.8

![image](https://github.com/Nguyen-Trung-Kien/Wordpress-CVE--Reproduct/assets/65381453/27c8fd18-a564-431d-9fcf-d527bfc6497e)

Order_by được fix ở bản mới

đoạn code này nằm trong func handle_params_for_query_courses,

Tìm kiếm các nơi sử dụng method này

![image](https://github.com/Nguyen-Trung-Kien/Wordpress-CVE--Reproduct/assets/65381453/3beb965d-e88a-48b0-a954-da855de6b703)

Có 3 nơi gọi tới hàm này.

Kiểm tra từng nơi

.1 Ở SkinCoursesBase.php
hàm này ở trong render_course
![image](https://github.com/Nguyen-Trung-Kien/Wordpress-CVE--Reproduct/assets/65381453/9fd0ff3a-ea5b-4655-b005-a72b69571b5d)

Tìm kiếm
![image](https://github.com/Nguyen-Trung-Kien/Wordpress-CVE--Reproduct/assets/65381453/7c43c346-c651-41fa-b995-060e4cc024f7)

chỉ có 1 nơi gọi là hàm render

Kiểm tra class có nơi nào gọi tới không
![image](https://github.com/Nguyen-Trung-Kien/Wordpress-CVE--Reproduct/assets/65381453/8ab0ca0e-6c02-4978-8fd1-0041881293bf)

2. ở Class-lp-rest-courses-controller.php
Hàm này có ở trong function list_courses
Kiểm tra có gọi hàm list_course ở đâu không
![image](https://github.com/Nguyen-Trung-Kien/Wordpress-CVE--Reproduct/assets/65381453/0a92b2f1-5783-49d5-906c-c857e2fccb97)

![image](https://github.com/Nguyen-Trung-Kien/Wordpress-CVE--Reproduct/assets/65381453/6502a887-137e-4c92-82d9-ad817e480203)

archive-course gọi tới list_courses

![image](https://github.com/Nguyen-Trung-Kien/Wordpress-CVE--Reproduct/assets/65381453/cdcdca5a-657c-40a6-8192-ed2ccb06dde4)

có được POC

![image](https://github.com/Nguyen-Trung-Kien/Wordpress-CVE--Reproduct/assets/65381453/4fd3def1-c9fe-432d-bf34-7623e242bd41)


POC:
```
http://127.0.0.1:8088/wp-json/lp/v1/courses/archive-course?order_by=1,sleep(4)
```
