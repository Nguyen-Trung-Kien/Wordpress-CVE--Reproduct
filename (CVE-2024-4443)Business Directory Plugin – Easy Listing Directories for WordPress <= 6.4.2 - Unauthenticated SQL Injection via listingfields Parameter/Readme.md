https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/business-directory-plugin/business-directory-plugin-easy-listing-directories-for-wordpress-642-unauthenticated-sql-injection-via-listingfields-parameter

CVe này nói rõ về parameter có lỗi
![image](https://github.com/Nguyen-Trung-Kien/Wordpress-CVE--Reproduct/assets/65381453/4c380ea3-a477-460a-948a-480a79da3f0e)

listingfields, tuy nhiên khi bạn thử sử dụng sqlmap hoặc công cụ exploit sql thì sẽ không exploit được.

Bật debug để kiểm tra dữ liệu

Tôi sẽ chọn 1 paramter để truy vấn

![image](https://github.com/Nguyen-Trung-Kien/Wordpress-CVE--Reproduct/assets/65381453/f47691c6-906f-4867-841e-05d693455df8)


```
http://localhost:8088/?dosrch=1&q=&page_id=17&wpbdp_view=search&listingfields[1]=xinchao
```

đoạn code cần chú ý

![image](https://github.com/Nguyen-Trung-Kien/Wordpress-CVE--Reproduct/assets/65381453/63356ea9-428d-4774-a134-ea9b20e55b53)

bật debug

array[1]= xinchao
![image](https://github.com/Nguyen-Trung-Kien/Wordpress-CVE--Reproduct/assets/65381453/e3c9f005-77cb-4727-a723-e430144f5cf4)

Thử payload
```
http://localhost:8088/?dosrch=1&q=&page_id=17&wpbdp_view=search&listingfields[hello][1]=xinchao
```

![image](https://github.com/Nguyen-Trung-Kien/Wordpress-CVE--Reproduct/assets/65381453/7abba143-7f2b-46bf-998b-3bd1f54d2c89)

ở đây tree[0] là hello và chỉ ra rằng đầu vào này có thể thao túng và xem thử hello sẽ đi tới đâu

HELLO sẽ nằm trong res
![image](https://github.com/Nguyen-Trung-Kien/Wordpress-CVE--Reproduct/assets/65381453/bf268514-f2da-4eb5-8dc0-2e789fb0a324)

Đoạn này sẽ truy vấn vào sql

![image](https://github.com/Nguyen-Trung-Kien/Wordpress-CVE--Reproduct/assets/65381453/c911498f-3ea9-4e03-a5a6-5815c14a0df6)


![image](https://github.com/Nguyen-Trung-Kien/Wordpress-CVE--Reproduct/assets/65381453/78160d56-56af-4036-a353-283f7a7dbc79)

POC
![image](https://github.com/Nguyen-Trung-Kien/Wordpress-CVE--Reproduct/assets/65381453/e7688af5-c4b5-4ae2-b9d4-8ca2750fd8b0)
